<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>派宝箱</title>
  <link href="css.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="js/jquery.js"></script>
  <script type="text/javascript" src="js/web.js"></script>
  <script type="text/javascript" src="js/delay.js"></script>
  <link href="js/swf.css" rel="stylesheet" type="text/css" />
</head>

	<style type="text/css">
		.key3 {
				padding: 5px 5px 5px 5px;
				margin: 2px 1px 1px 1px;
				font-weight:800;
				font-size: 30px;
				line-height: 60px;
				text-align:center;
				width:60px;
				height:60px
				color: #666666;
				background-image:url(images/imgs/UI_2_01/UI_2_12.png)
			
			}
		.key0 {
				padding: 5px 5px 5px 5px;
				margin: 2px 2px 1px 1px;
				font-weight:900;
				font-size: 30px;
				line-height: 60px;
				text-align:center;
				width:160px;
				height:60px
				color: #666666;
				background-repeat:no-repeat;				
				background-image:url(images/imgs/UI_2_01/UI_4-017.png);
			
			}
			.key1 {
				padding: 0px 2px 0px 2px;
				margin: 4px 1px 1px 1px;
				background-repeat:no-repeat;				
				
			
			}
				.key2 {
				padding: 5px 5px 5px 5px;
				
				margin: 8px 2px 1px 1px;
				font-weight:900;
				font-size: 30px;
				line-height: 150px;
				text-align:center;
				width:60px;
				height:150px
				color: #666666;
				background-repeat:no-repeat;
				background-image:url(images/imgs/EUI_2_01/UI_4-018.png)				
				
			
			}
	
 .allback{
  display:none;
  align:center;
  }
  
  .shade{
  background:#000000;
  position:absolute;
  left:0;
  right:0;
  top:0;
  bottom:0;
  width:1024px;
  height:768px;
  filter:alpha(opacity=50); 
  opacity:0.5;
  }
 
  .phonehint{
  position:absolute;
  left:0PX;
  top:0px;
  width:1024px;
  height:768px;
  display:none;

  }
  .phonehintbackground{
  position:relative;
  top:200px;
  }
  .phonehintnum{
  align:center;
  position:absolute;
  top: 110px;
  height:100px;
  width:1024px;
  line-height:100px;
  left: 0px;
  }
  .phonehintbtn{
  position:absolute;
  width:1024px;
  left:0px;
  top: 265px;
  }
 	
  .paymoneyhint{
  position:absolute;
  left:0PX;
  top:0px;
  width:1024px;
  height:768px;
  display:none;
  }
  .paymoneyback{
  position:absolute;
  width:1024px;
  height:768px;
  padding-top:375PX;
  left: 4px;
  top: -179px;
  }
 .paymoney{
 text-align:left;
  position:absolute;
  top: 389px;
  height:327px;
  width:750px;
  line-height:100px;
  left: 138px;
  }
  .selectpaybutton{
  position:absolute;
  width:1024px ;
  left: -5px;
  top: 722px;
  }
  
  .paysucceedhint{
   position:absolute;
  left:0PX;
  top:0px;
  width:1024px;
  height:768px;
  display:none;
  }
  .showpaymoneyhint{
  height:80px;
  width:750px;
  margin-top:5px;
  
  
  }
  .allhint{
  
   position:absolute;
  left:0PX;
  top:0px;
  width:1024px;
  height:768px;
  display:none;
  }
	</style>
<body>
<div style=" position:relative">
<img src="images/imgs/EUI_2_01/allbg.png" no-repeat/>
</div>
<div style=" position:absolute; left:0px;top:0px; "> 
<div class="w1024 info_all">

			  <div>
						<!--跳回首页-->
						<div  align="left" style=" margin-left:30px;margin-top:30px"> 
						<img id="TurnIndex" src="images/imgs/UI_2_01/UI_2-22.png"/> 	
						</div>
						<!--请输入电话号码的提示-->
						<div class="inputphonehint"	> <img src="images/imgs/UI_2_01/UI_4_15.png" style="width:500px"  /></div>
						<!--称重和应付金额的显示  -->
							<div class="inputphonekeyboard" align="center" style="margin-top:20px">
								  <div style="width:540px; height:190px" >
										<!--电话号码的输入框-->
										<div style="position:relative" >
											  <div style="position:absolute; left:0px;">
												<!--输入框背景色-->
												<img src="images/imgs/UI_2_01/UI_2_11.png" width="520px" height="80px"/> 
											  </div>
										
											  <div id="inputphone1" style="position:absolute; left:15px;top:5px">
												<!--输入框-->
											<input name="text2" type="text"  id="inputphone" style="width:500px; height:60px; text-align:left; line-height:70px; border:0px;background-color:transparent; font-size:60px; text-align:center" value="" />
											  </div>
											  <div style="position:absolute; left:0px; top:90px">
												<!--输入框背景色-->
												<img src="images/imgs/UI_2_01/UI_2_11.png" width="520px" height="80px"/> 
											  </div>
										
											  <div id="inputphoneAgain1" style="position:absolute; left:15px;top:95px">
												<!--输入框-->
												<input name="text" type="text"  id="inputphoneAgain" style="width:500px; height:60px; text-align:left;text-align:center; line-height:70px; border:0px;background-color:transparent; font-size:60px" value="" />
												
											  </div>
										</div >
										
								  </div>
									  <!-- 模拟键盘-->
									  <div class="keyboard" style="margin-top:-5PX" >
										<table>
										  <tr>
											<td><div class="key key3" id="1"><span >1</span></div></td>
											<td><div class="key key3" id="2"><span >2</span></div></td>
											<td><div class="key key3" id="3"><span  >3</span></div></td>
											
											<td rowspan="2"><div class="key key2" id="0"><span >0</span></div></td>
										  </tr>
										  <tr>
											<td><div class="key key3" id="4"><span>4</span></div></td>
											<td><div class="key key3" id="5"><span>5</span></div></td>
											<td><div class="key key3" id="6"><span>6</span></div></td>
										  </tr>
										  <tr>
											<td><div class="key key3" id="7"><span   >7</span></div></td>
											<td><div class="key key3" id="8"><span  >8</span></div></td>
											<td><div class="key key3" id="9"><span  >9</span></div></td>
											<!--确定按钮-->
											<!--取消按钮-->
											<td><div class="key " id="del" style="background-image:url(images/imgs/UI_2_01/UI_2_12.png); width:70px; height:70px;"><img src="images/imgs/UI_2_01/UI_4_16.png" style="margin-top:10px"/></div></td>
										  </tr>
										  <tr>
										   <!--取消按钮-->
										  <td colspan="2"><div class="key1" id="return1"><img src="images/imgs/UI_2_01/UI_2_7.png"/></div></td>
										   <!--确定按钮-->
											<td colspan="2"><div class="key key1" id="ok"><img src="images/imgs/UI_2_01/UI_2_10.png"/></div></td>
										 			
										
									  </tr>
										</table>
									  </div>
							</div>
						
						
						
			  </div>
			  
			  	<!--模拟提示框--------------------------------------------------------------------------------->
			<div class="allback">
				 <!--模拟透明隔板-->
				 <div class="shade">
				 	
					
				 </div>
				 <!--输入电话号码提示信息--------------------------------------------------------------->
				 <div class="phonehint">
				 		<!--提示输入电话号码提示框的背景-->
						<div class="phonehintbackground">
						      <img  src="images/imgs/UI_2_01/UI_2_13.png"/>
							  <!--得到的电话号码-->
							  <div class="phonehintnum">
							  <span id="phonehintnum" style="font-size:80px; text-align:center"></span>	
							  </div>
		
							  <!--电话提示框的确定，取消按钮-->
							  <div class="phonehintbtn">
							  <!--电话号码提示框的取消按钮-->
							  <img src="images/imgs/UI_2_01/UI_2_20.png" id="cancelphonehint" style="padding-right:20px"/> 
							  <!--电话号码提示框的确定按钮-->
							  <img src="images/imgs/UI_2_01/UI_2_21.png" id="okphonehint" style="padding-left:20px"/>							  							  </div>
						</div>
						
				 </div>
				 
				 <!--八达通付款提示信息---------------------------------------------------------------->
				 <div class="paymoneyhint">
						<!-- 显示支付金额--> 
						<div class="img1 paymoneyback"> 
						<img src="images/imgs/UI_2_01/UI_2_23.png"/>  
										
										<div class="paymoney">
										  <!--金额显示信息-->
												 <div class="showpaymoneyhint" align="center" >
													<div style=" width:430px">
														<div style="width:200px; float:left" >
														<img src="images/imgs/UI_2_01/UI_2_25.png" />
														</div>
														<div style="width:210px; float:left">
														<span id="paymentamount" style="font-size:70px; text-align:left; height:80px; line-height:  80px; color:#99ca3b ">131.0</span>
														</div>
													</div>
																										
												 </div>
											  <!--温馨提示信息-->
												  <div align="center" style=" margin-top:5px;">
												  <img  id="paymoneyhintsentence"  src="images/imgs/UI_2_01/UI_2_24.png"/>
												  </div>
												  
											  <!--显示八达通的图片-->
												  <div align="center" style="margin-top:5px"> 
												  <img src="images/imgs/UI_2_01/UI_2_26.png" id="eightcard"/>	
												  </div>
										</div>
										<!--选择按钮-->
										<div class="selectpaybutton" >
													<!--电话号码提示框的确定按钮-->
												  <img src="images/imgs/UI_2_01/UI_2_27.png" id="cancelpaymoney"/>									                                   	 </div>
						
						</div >
			 
				 </div>
				<!--支付成功提示--------------------------------------------------------------->
				 <div class="paysucceedhint">
				 		
						<div class="paymoneyback"> 
						<!-- 提示框背景--> 
						<img src="images/imgs/UI_2_01/UI_2_23.png"/>  
										<!--支付成功提示框-->
										<div class="paymoney">
										
												  <!--温馨提示信息-->
												  <div align="center" style=" margin-top:15px;">
												  <img src="images/imgs/UI_2_01/UI_2_paysucceedhint.png"/>
												  </div>
										         <!--金额显示信息-->
												 <div style="height:150px; width:750px;" align="center">
												 	    <!--扣除金额-->
														<div style=" width:480px; height:70px; margin-top:5px">
															<div style="width:265px; float:left" >
															<img src="images/imgs/UI_2_01/UI_2_tackoffmoney.png" />
															</div>
															<div style="width:210px; float:left" align="left">
															<span id="tackmoney" style="font-size:50px; width:210px; color:#99ca3b; text-align:left; height:60px; line-height: 60px; ">15550.0</span>
															</div>
														</div>
														<!--余额-->
														<div style=" width:570px; height:70px; padding-top:25px">
															<div style=" float:left; margin-left:140px; padding-top:5px" ><img src="images/imgs/UI_2_01/UI_2_balance.png" /></div>
															<div style="width:210px; float:left ; height:60px; line-height:60px;" align="left">
															<span id="balance" style="font-size:50px; width:210px; text-align:left;color:#99ca3b;">130.0</span>
															</div>
														</div>
																										
												 </div>
										
										</div>
										
						</div >
					
				 </div>
				 <!--交易取消-------------------------------------------------------------------------------->
				 <div class="allhint">
				 		
						<div class="paymoneyback"> 
						<!-- 提示框背景--> 
						<img src="images/imgs/UI_2_01/UI_2_23.png"/>  
										
										<div class="paymoney">
										
												  <!--温馨提示信息-->
												 
												  
												  <table  style="height:350px; line-height:350px; width:750px; text-align:center; border:0 "><tr><td>
												  <img id="hints" />
												  </td></tr></table>
												   
												  
										</div>	 
						</div >
					
				 </div>
				 
		
				 <!---------------------------------------------------------------------------------->
  </div>
  
</div>
<span style="position:absolute; left:10px;top:5px">

</span></div>
</body>
<script>
$(function(){
	//操作模拟键盘
		var IntervalId=""
			var IntervalId1=""
				var returnThing=false;
	$("#TurnIndex").click(
	function(){
	if(returnThing==true)
					return;	
	geturl('index.html')
	});
	$("#return1").click(
	function(){
	if(returnThing==true)
					return;	
	geturl('index.html')
	});
	var s="";
	var b="";
	var a=1;
	var weight=getUrlParam('weight');
	var TotalCost=getUrlParam('TotalCost')
	$(".keyboard .key").click(
								  
			function() {
				if(returnThing==true)
					return;	
					//判断光标在那个输入框中
				if($("#inputphone").val()==""&&$("#inputphoneAgain").val()=="")
				{
				$("#inputphone").css("color","black");
				$("#inputphoneAgain").css("color","black");
				a=1;
				}
				$("#inputphone1").click(function()
				{
				
					a=1;
					
				});
				$("#inputphoneAgain1").click(function()
				{
				a=2
				
				});
				
				if ($(this).attr('id') == "del") {
						if($("#inputphone").val()=="")
						{
						a=2;
						}
						if($("#inputphoneAgain").val()=="")
						{
						a=1;
						}
						if(a==1){
						//删除上面输入框的信息
							var len=$("#inputphone").val().length-1;
							s=s.substring(0, len); 
							$("#inputphone").val($("#inputphone").val().substring(0, len));
							if($("#inputphone").val().length<=8)
							{
							
							//$("#inputphone").removeAttr("disabled");
							$("#inputphone").css("color","black");
							}
							
						}
						else if(a==2)
						{
						//删除下面输入框的信息
							var len=$("#inputphoneAgain").val().length-1;
							b=b.substring(0, len); 
							$("#inputphoneAgain").val($("#inputphoneAgain").val().substring(0, len));
							if($("#inputphoneAgain").val().length<=8)
							{
							
							//$("#inputphoneAgain").removeAttr("disabled");
							$("#inputphoneAgain").css("color","black");
							}
							if($("#inputphoneAgain").val()=="")
							{
							a=1;
							}
						}
					
				}
				
				else if($(this).attr('id') == "ok")
				{
				a=1;
					if(!(/(^1[3|4|5|8][0-9]\d{4,8}$|^\d{8}$)/.test(s))||s==""||b=="")
					{
						//ms('系統提示','PhoneTiShi.png');
						ms2('images/imgs/UI_TISHIVIEW/UI_2_21.png',"images/imgs/UI_TISHIVIEW/PhoneTiShi.png");
						s="";
						b="";
						$("#inputphone").val("");
						$("#inputphoneAgain").val("");
						
					}
					else if(s==b&&s!=""&&b!="")
					{
						
						//模拟提示框遮罩
							//$(".allback").show();
							//输入电话号码的提示
							//$("#phonehintnum").text(s);
							//将确定电话号码提示框显示出来
							//$(".phonehint").show();
							
						  returnThing=true;
					 //判断是否有格口
				  var retu=ebox.LookFreeBox()	
				  if(retu=='1')
			      { 
					//将八达通支付提示界面显示出来
					 $(".allback").show();
					  var openedNo1 = ebox.onlyGetDoorNo(weight);	

					  if(openedNo1!="0") {
							  setTimeout(function(){
							 ebox.expressCardInit();
							 ebox.octopusCardCmd(1,0,weight,0,'01',openedNo1,s,0,0,0,0,TotalCost,0,'0001-1-1',0,0);
							
							},50);
									IntervalId1=window.setInterval(function()
								  {
									 var r=ebox.returnCardReply();
									 var openedNo=""
											if(r==1)
											 {	
											returnThing=false;		
											window.location.href="OpenTheDoorPage.html?weight="+weight;
											$(".allback").hide();
										   ebox.expressCardInit();
										   //$("#inputphone").val();
											  clearInterval(IntervalId1);
											  s="";
								b="";
								$("#inputphone").val("");
								$("#inputphoneAgain").val("");
											 }
											  else if(r==2)
											 {
											 returnThing=false;
											  $(".allback").hide()
											  ebox.expressCardInit();
											   //$("#inputphone").val("");
											  // $("#inputphone").val();
											   clearInterval(IntervalId1);
											   s="";
								b="";
								$("#inputphone").val("");
								$("#inputphoneAgain").val("");
											  
											 }
								  },1000);
								  }
								  else{
								  //没有合适的格口，请选择小的格口
								  geturl('SelectOtherDoorPage.html');
								  }
						
						 }
						else
						{
						s="";
								b="";
								$("#inputphone").val("");
								$("#inputphoneAgain").val("");
							geturl('DoorFullPage.html');
						}		  	
					
					}
					else if(s!=b)
					{
					s="";
						b="";
						$("#inputphone").val("");
						$("#inputphoneAgain").val("");
					//alert("两次电话号码输入不一致！！！");
ms2('images/imgs/UI_TISHIVIEW/UI_2_21.png',"images/imgs/UI_TISHIVIEW/InpuntDiffernet.png");

					}
				
				}
				
				else 
				{
				
						if(a==1)
						{
							//给输入框限制长度
									
								s=s+$(this).attr('id');//拿到点击的按钮的id值
						
									//给输入框限制长度
									if ($("#inputphone").val().length>=8) 
									{
									
										$("#key").unbind("click");
										//让文本框不能更改状态
										//color:#999999
										$("#inputphone").css("color","#999999");
										s=s.substring(0, 8);
										a=2;
										
									}
									else
									{
										
										if($("#inputphone").focus())
										{
										
												var asterisk="";
												if(s.length<=4)
												{
													for(var i=0; i<s.length-1;i++)
													{
													
													asterisk+="*"
													}
													
												}
												else
												{
													if(s.length<=8)
													{
													asterisk="****"+s.substring(4,s.length-1);
													}
													//else if(s.length>8)
//													{
//													
//														for(var i=0; i<s.length-3;i++)
//															{
//															
//															asterisk+="*"
//															}
//														asterisk=asterisk+s.substring(s.length-3,s.length-1);
//														
//													}
													
												}
											$("#inputphone").val(asterisk+$(this).attr('id'));
											if($("#inputphone").val().length>=8)
											{
											$("#key").unbind("click");
										//让文本框不能更改状态
										//color:#999999
										$("#inputphone").css("color","#999999");
										s=s.substring(0, 8);
											a=2;
											if($("#inputphoneAgain").val().length<8){
											$("#inputphoneAgain").focus();
											}
											}
									     }
									}
								//$('#inputphone').val(s);
						}
						else if(a==2)
						{
	
                            
								b=b+$(this).attr('id');//拿到点击的按钮的id值
								
									//给输入框限制长度
									if ($("#inputphoneAgain").val().length>=8) 
									{
									
										$("#key").unbind("click");
										//让文本框不能更改状态
										$("#inputphoneAgain").css("color","#999999");
										//$("#inputphoneAgain").attr("disabled","true");
										b=b.substring(0, 8);
										a=1;
									}
									else
									{
									
										
										if($("#inputphoneAgain").focus())
										{
										
												var asterisk="";
												if(b.length<=4)
												{
													for(var i=0; i<b.length-1;i++)
													{
													
													asterisk+="*"
													}
													
												}
												else
												{
													if(b.length<=8)
													{
													asterisk="****"+b.substring(4,b.length-1);
													}
													//else if(b.length>8)
//													{
//													
//														for(var i=0; i<b.length-3;i++)
//															{
//															
//															asterisk+="*"
//															}
//														asterisk=asterisk+b.substring(b.length-3,b.length-1);
//														
//													}
													
												}
											$("#inputphoneAgain").val(asterisk+$(this).attr('id'));
												if($("#inputphoneAgain").val().length>=8){
													$("#key").unbind("click");
										//让文本框不能更改状态
										$("#inputphoneAgain").css("color","#999999");
										//$("#inputphoneAgain").attr("disabled","true");
										b=b.substring(0, 8);
											a=1;
												if($("#inputphone").val().length<8){
												$("#inputphone").focus();
												}
											}
										
									     }
										
									}
						}
						
					
				}		
			});
			
			
			//隐藏电话提示输入框
			$(".allback #cancelphonehint").click(
			function(){
			
			$(".allback").hide();
			$(".phonehint").hide();
			$("#phonehintnum").text();
			$("#inputphone").val("");
			s="";
			
			});
			////电话号码提示框的确定按钮提示
//			$("#okphonehint").click(
//					function(){
//					//隐藏确认电话提示框
//				//	$(".allback").css("display", "none");
//				// $(".allback").hide();
//			        $(".phonehint").hide() ;
//			    	$("#inputphone").val("");
//				    returnThing=true;
//					 //判断是否有格口
//					var retu=ebox.LookFreeBox()	
//				if(retu=='1')
//			      { 
//					//将八达通支付提示界面显示出来
//					  var openedNo1 = ebox.onlyGetDoorNo(weight);	 
//					  setTimeout(function(){
//					 ebox.expressCardInit();
//					 ebox.octopusCardCmd(1,0,weight,0,'01',openedNo1,s,0,0,0,0,TotalCost,0,'0001-1-1',0,0);
//					},50);
//							IntervalId1=window.setInterval(function()
//						  {
//					    	 var r=ebox.returnCardReply();
//						     var openedNo=""
//									if(r==2)
//									 {	
//									returnThing=false;		
//									window.location.href="OpenTheDoorPage.html?weight="+weight;
//								    $(".allback").hide();
//								   ebox.expressCardInit();
//								   $("#inputphone").val();
//									  clearInterval(IntervalId1);
//									 }
//									  else if(r==3)
//									 {
//									 returnThing=false;
//									  $(".allback").hide()
//									  ebox.expressCardInit();
//									   $("#inputphone").val("");
//									   $("#inputphone").val();
//									   clearInterval(IntervalId1);
//									  
//									 }
//						  },1000);
//			     }
//				else
//				{
//					geturl('DoorFullPage.html');
//				}		  	
//					});
			//取消支付
			function paymoney()
			{
			}
			
			$(".allback #cancelpaymoney").click(
			function(){
			
			$(".allback").hide();
			$(".paymoneyhint").hide();
			$("#inputphone").val("");
			s="";
			
			});
			
			//点击八达通图片时提交数据和跳转
			
	$('#eightcard').click(function(){
	
		
		
		
		ebox.SaveJiJianInfo(proNo,proName,cityNo,cityName,conNo,conName,pkgName,recName,recPhone,recAddr);
		//跳转到格口打开界面
		//拿到要开的格口编号
		
		//跳转到格口打开界面
		if(openedNo==""){
		var timeout2 = 6;
		 var timer2 = '';
		function timedCount2()
		{
			timeout2 = timeout2 -1;
			
			
			if(timeout2<=0){
				
			}
			timer2 = setTimeout("timedCount2()",1000)
		};
			
		}
		
		
	});

			
	


});


</script>

<script type="text/javascript">
var t = null;
ebox.SetBizCode('EBOX2008');
$(function(){
ebox.StartCamera();
t = setInterval(function() { 
	timeget();
}, 1000);
});

var timetxt = 0;
function timeget(){
	timetxt++;
	if(timetxt==4){
		clearInterval(t);
		ebox.CloseCamera();
		return false;
	}
	
	ebox.Snapshot();
}
$(function() {
	$(this).doTimeout('EBOX2008', lazyTime, function() {
		//loadCustInfo();
	});
});

		

	
	$('#eightcard').click(function(){
		if($.trim($("#txt_tel").val()) == ''){
			ms('系統提示','貨物信息不能為空');
			return;
		}
		if($.trim($("#txtsl1").val()) == ''){
			ms('系統提示','收件人姓名不能為空');
			return;
		}
		if($.trim($("#jiJianTelTxt").val()) == ''){
			ms('系統提示','收件人電話不能為空');
			return;
		}
		if($.trim($("#txtsl3").val()) == ''){
			ms('系統提示','收件人地址不能為空');
			return;
		}
		
		var proNo =$('#s_province :selected').val();
		var proName= $('#s_province :selected').text();
		var cityNo = $('#s_city :selected').val();
		var cityName= $('#s_city :selected').text();
		var conNo = $('#s_county :selected').val();
		var conName= $('#s_county :selected').text();
		
		var pkgName = $.trim($("#txt_tel").val());
		var recName = $.trim($("#txtsl1").val());
		var recPhone = $.trim($("#inputphone").val());
		var recAddr = $.trim($("#txtsl3").val());
		
		ebox.SaveJiJianInfo(proNo,proName,cityNo,cityName,conNo,conName,pkgName,recName,recPhone,recAddr);
		
	});



</script>

</html>